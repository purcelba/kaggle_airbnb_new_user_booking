# Kaggle challenge | Airbnb New User Bookings

The Python code in this repository implements the data analysis and modeling used for the Kaggle Airbnb New User Bookings challenge.  You can read about the analysis in detail in [my blog post](https://purcelba.github.io/Kaggle-airbnb/).  Briefly, the goal of this challenge was to predict which country a new Airbnb user's first booking destination will be based on a set of demographics and web session records. Additionally, I used model-based analysis to understand which factors are most predictive about whether a new user would book a destination. 

## Data
You can find the relevant data files [here](https://www.kaggle.com/c/airbnb-recruiting-new-user-bookings/data).  To use the code you should download the repository and unzip the contents of the data files to the /data diretory.  This should include sessions.csv, test_users.csv, and train_users_2.csv. Per Kaggle guidelines, I cannot directly provide data files.

## Notebooks
Check out the [airbnb_data_exploration.ipynb](https://github.com/purcelba/kaggle_airbnb_new_user_booking/blob/master/notebooks/airbnb_data_exploration.ipynb) Jupyter notebook for code and plots summarizing the data set.
Check out the [airbnb_models.ipynb](https://github.com/purcelba/kaggle_airbnb_new_user_booking/blob/master/notebooks/airbnb_models.ipynb) Jupyter notebook for code and plots summarizing validation and comparison of the different models.

## Code
The core functions are found in the airbnb directory.

Feature engineering is handled by two functions:
- format_sessions.py, format the sessions data for subsequent modeling.  It generates indicator variables for each combination of action name, type, and detail to be joined with user demographic data. The resulting .csv files should be saved in the /data directory.
- feateng.py, returns a formatted feature matrix to be used for modeling.  It uses the .csv files generated by format_sessions.py if sessions data are requested.

Model fitting is handled by the following three functions:
- logregModel.py, fit an L1-regularized logistic regression model implemented in scikit-learn to the kaggle-
airbnb data set using 5-fold cross-validation to find the optimal regularization term.
- xgbModel.py, fit XGBoost model implemented in scikit-learn to the kaggle-airbnb data set.  Use randomized
search with 5-fold cross-validation to select the hyperparameters. 
- kerasModel.py, fit a multilayer perceptron model implemented in Keras with a fixed set of hyperparameters
to the airbnb data.
Models fitted using these functions are saved .h5 or .sav files that can be loaded and analyzed.

## Figures
Summary figures of model fits.  See [my blog post](https://purcelba.github.io/Kaggle-airbnb/) or [airbnb_models.ipynb](https://github.com/purcelba/kaggle_airbnb_new_user_booking/blob/master/notebooks/airbnb_models.ipynb) for more information.

## Requirements
This code is written in Python 2.7 and requires
- pandas, numpy, scipy for computation.
- scikit-learn, xgboost, keras for model fitting.
- matplotlib, seaborn for data visualization
